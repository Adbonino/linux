## Auto-Inicio de un contenedor

### Pre-requisitos:

```
 [abonino@server1 ~]$ loginctl enable-linger abonino
 [abonino@server1 ~]$ loginctl show-user abonino | grep -i linger
 Linger=yes
 [abonino@server1 ~]$ podman pull docker.io/library/mediawiki
 [abonino@server1 ~]$ podman images
 REPOSITORY                                       TAG     IMAGE ID      CREATED       SIZE
 docker.io/library/mediawiki                      latest  b6b39cabd870  4 days ago    830 MB
 [abonino@server1 ~]$ mkdir /home/abonino/paginas
 [abonino@server1 ~]$ chmod 777 /home/abonino/paginas
 [abonino@server1 ~]$ podman run -d --name My_wiki -p 4567:80 -v /home/abonino/paginas:/var/www/data:Z docker.io/library/mediawiki
 [abonino@server1 ~]$ podman ps
 CONTAINER ID  IMAGE                        COMMAND               CREATED         STATUS             PORTS                 NAMES
 5ac1e0ca5965  docker.io/library/mediawiki  apache2-foregroun...  29 minutes ago  Up 29 minutes ago  0.0.0.0:4567->80/tcp  My_wiki
```  

### Configuración del servicio
```
 [abonino@server1 ~]$ mkdir .config/systemd/user
 [abonino@server1 ~]$ cd .config/systemd/user
 [abonino@server1 user]$ podman generate systemd --name My_wiki --files --new
 [abonino@server1 user]$ ll
 -rw-r--r--. 1 abonino abonino 886 Aug  3 00:17 container-My_wiki.service
 [abonino@server1 user]$ vi container-My_wiki.service
 # container-My_wiki.service
 # autogenerated by Podman 3.0.2-dev
 # Tue Aug  3 00:17:25 -03 2021
 
 [Unit]
 Description=Podman container-My_wiki.service
 Documentation=man:podman-generate-systemd(1)
 Wants=network.target
 After=network-online.target
 
 [Service]
 Environment=PODMAN_SYSTEMD_UNIT=%n
 Restart=on-failure
 TimeoutStopSec=70
 ExecStartPre=/bin/rm -f %t/container-My_wiki.pid %t/container-My_wiki.ctr-id
 ExecStart=/usr/bin/podman run --conmon-pidfile %t/container-My_wiki.pid --cidfile %t/container-My_wiki.ctr-id --cgroups=no-conmon --replace - 
 d --name My_wiki -p 4567:80 -v /home/abonino/paginas:/var/www/data:Z docker.io/library/mediawiki
 ExecStop=/usr/bin/podman stop --ignore --cidfile %t/container-My_wiki.ctr-id -t 10
 ExecStopPost=/usr/bin/podman rm --ignore -f --cidfile %t/container-My_wiki.ctr-id
 PIDFile=%t/container-My_wiki.pid
 Type=forking
 
 [Install]
 WantedBy=default.target     # dejar solo este target
 [abonino@server1 user]$ systemctl --user daemon-reload
 [abonino@server1 user]$ systemctl --user enable container-My_wiki.service
 [abonino@server1 user]$ ll
 -rw-r--r--. 1 abonino abonino 886 Aug  3 00:17 container-My_wiki.service
 drwxr-xr-x. 2 abonino abonino  39 Aug  3 00:19 default.target.wants
 
 [abonino@server1 user]$ tree
 .
 ├── container-My_wiki.service
 └── default.target.wants
     └── container-My_wiki.service -> /home/abonino/.config/systemd/user/container-My_wiki.service
 
 1 directory, 2 files
 [abonino@server1 user]$ systemctl --user status container-My_wiki.service
 [abonino@server1 user]$
```
